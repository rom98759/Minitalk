# =============================================================================
#	๐ GENERAL CONFIG & FLAGS ๐
# =============================================================================

# Program for compiling C programs
CC := cc
CFLAGS := -Wall -Wextra -Werror $(INCLUDES)

NAME_SERVER := server
NAME_CLIENT := client

# =============================================================================
#	๐๏ธ MANDATORY PART ๐๏ธ
# =============================================================================

SRC_SERVER := server.c server_utils.c
SRC_CLIENT := client.c

SRC_SERVER_BONUS := server_bonus.c server_utils_bonus.c
SRC_CLIENT_BONUS := client_bonus.c

INCLUDES := -I. -Ilibft

LIBFT := ./libft/libft.a
LIBFT_PATH := ./libft

# =============================================================================
#	๐๏ธ RULES ๐๏ธ
# =============================================================================

all: $(NAME_SERVER) $(NAME_CLIENT)
	@echo "๐ All done! Time to shine! ๐"

# Compile SERVER
$(NAME_SERVER): $(SRC_SERVER) $(LIBFT)
	@$(CC) $(CFLAGS) $(SRC_SERVER) $(LIBFT) -o $(NAME_SERVER)
	@echo "๐ Server compiled with flying colors!"

# Compile CLIENT
$(NAME_CLIENT): $(SRC_CLIENT) $(LIBFT)
	@$(CC) $(CFLAGS) $(SRC_CLIENT) $(LIBFT) -o $(NAME_CLIENT)
	@echo "๐ซ Client ready for action!"

# Clean object files (*.o)
clean:
	@rm -f *.o
	@echo "๐งน Object files swept away!"

# Clean object files (*.o) and binaries
fclean: clean
	@rm -f $(NAME_SERVER) $(NAME_CLIENT)
	@echo "๐ฅ $(NAME_SERVER) and $(NAME_CLIENT) obliterated!"

# Recompile everything
re: fclean all
	@echo "๐ Recompiling... Give it a sec!"

# =============================================================================
#	๐ LIBFT RULES ๐
# =============================================================================

# Make libft
$(LIBFT):
	@cd $(LIBFT_PATH) && make -s bonus
	@echo "๐ฆ libft assembled with magic spells!"

clean_libft:
	@cd $(LIBFT_PATH) && make -s clean
	@echo "๐งน libft object files tidied up!"

fclean_libft:
	@cd $(LIBFT_PATH) && make -s fclean
	@echo "๐ฅ libft files completely wiped!"

re_libft:
	@cd $(LIBFT_PATH) && make -s re
	@echo "๐ libft rebuilt! It's like brand new!"

# =============================================================================
#	๐ BONUS PART ๐
# =============================================================================

bonus: $(SRC_SERVER_BONUS) $(SRC_CLIENT_BONUS) $(LIBFT)
	@$(CC) $(CFLAGS) $(SRC_SERVER_BONUS) $(LIBFT) -o $(NAME_SERVER)
	@$(CC) $(CFLAGS) $(SRC_CLIENT_BONUS) $(LIBFT) -o $(NAME_CLIENT)
	@echo "โจ Compiled with bonus powers! โจ"

rebonus: fclean bonus
	@echo "๐ Recompiled everything with bonus content! Extra flavor unlocked!"

# =============================================================================
#	๐ฉ EASTER EGG ๐ฉ
# =============================================================================

heart:
	@echo "                    "
	@echo "    โค๏ธโค๏ธ    โค๏ธโค๏ธ    "
	@echo "  โค๏ธ    โค๏ธโค๏ธ    โค๏ธ  "
	@echo " โค๏ธ      โค๏ธ      โค๏ธ "
	@echo "  โค๏ธ            โค๏ธ  "
	@echo "    โค๏ธ        โค๏ธ    "
	@echo "      โค๏ธ    โค๏ธ      "
	@echo "        โค๏ธโค๏ธ        "
	@echo "         โค๏ธ         "
	@echo "                    "

# =============================================================================
#	๐ผ PHONY RULES ๐ผ
# =============================================================================

.PHONY: all clean fclean re clean_libft fclean_libft re_libft bonus rebonus heart
